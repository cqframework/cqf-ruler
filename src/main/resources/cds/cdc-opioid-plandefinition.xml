<PlanDefinition xmlns="http://hl7.org/fhir">
    <id value="cdc-opioid-05"/>
    <text>
        <status value="generated"/>
        <div xmlns="http://www.w3.org/1999/xhtml">CDC Opioid Prescribing Guideline Recommendation #5</div>
    </text>
    <url value="http://hl7.org/fhir/ig/opioid-cds/PlanDefinition/cdc-opioid-05"/>
    <identifier>
        <use value="official"/>
        <value value="cdc-opioid-05"/>
    </identifier>
    <version value="0.1.0"/>
    <name value="cdc-opioid-05"/>
    <type>
        <coding>
            <system value="http://hl7.org/fhir/plan-definition-type"/>
            <code value="eca-rule"/>
            <display value="ECA Rule"/>
        </coding>
    </type>
    <title value="CDC Opioid Prescribing Guideline Recommendation #5"/>
    <status value="draft"/>
    <date value="2017-04-23"/>
    <publisher value="Centers for Disease Control and Prevention (CDC)"/>
    <description value="When opioids are started, providers should prescribe the lowest effective dosage."/>
    <purpose value="CDC’s Guideline for Prescribing Opioids for Chronic Pain is intended to improve communication between	providers and patients about the risks and benefits of opioid therapy for chronic pain, improve the safety and effectiveness of pain treatment, and reduce the risks associated with long-term opioid therapy, including opioid use disorder and overdose. The Guideline is not intended for patients who are in active cancer treatment, palliative care, or end-of-life care."/>
    <usage value="Providers should use caution when prescribing opioids at any dosage, should carefully reassess evidence of individual benefits and risks when considering increasing dosage to ≥50 morphine milligram equivalents (MME)/day, and should avoid increasing dosage to ≥90 MME/day or carefully justify a decision to titrate dosage to >90 MME/day"/>
    <topic>
        <text value="Opioid Prescribing"/>
    </topic>
    <relatedArtifact>
        <type value="documentation"/>
        <display value="CDC guideline for prescribing opioids for chronic pain"/>
        <url value="https://guidelines.gov/summaries/summary/50153/cdc-guideline-for-prescribing-opioids-for-chronic-pain---united-states-2016#420"/>
    </relatedArtifact>
    <relatedArtifact>
        <type value="documentation"/>
        <display value="MME Conversion Tables"/>
        <url value="https://www.cdc.gov/drugoverdose/pdf/calculating_total_daily_dose-a.pdf"/>
    </relatedArtifact>
    <action>
        <!-- We can use the example code systems from the FHIR CLinical Reasoning Module, or we can define GRADE specific code systems and use those here -->
        <extension url="http://hl7.org/fhir/StructureDefinition/cqif-strengthOfRecommendation">
            <valueCodeableConcept>
                <coding>
                    <system value="http://hl7.org/fhir/recommendation-strength"/>
                    <code value="strong"/>
                    <display value="Strong"/>
                </coding>
            </valueCodeableConcept>
        </extension>
        <extension url="http://hl7.org/fhir/StructureDefinition/cqif-qualityOfEvidence">
            <valueCodeableConcept>
                <coding>
                    <system value="http://hl7.org/fhir/evidence-quality"/>
                    <code value="low"/>
                    <display value="Low quality"/>
                </coding>
            </valueCodeableConcept>
        </extension>
        <title value="High risk for opioid overdose.">
            <extension url="http://hl7.org/fhir/StructureDefinition/cqif-cqlExpression">
                <valueString value="'High risk for opioid overdose - ' + case when MME >= 90 then 'taper now' else 'consider tapering' end"/>
            </extension>
        </title>
        <!-- TODO: This description needs to include the table for MME? -->
        <description value="Total morphine milligram equivalent (MME) exceeds recommended amount. Taper to < 50.">
            <extension url="http://hl7.org/fhir/StructureDefinition/cqif-cqlExpression">
                <valueString value="'Total morphine milligram equivalent (MME) is ' + ToString(MME) + '. Taper to < 50.'"/>
            </extension>
        </description>
        <documentation>
            <type value="documentation"/>
            <display value="CDC guideline for prescribing opioids for chronic pain"/>
            <url value="https://guidelines.gov/summaries/summary/50153/cdc-guideline-for-prescribing-opioids-for-chronic-pain---united-states-2016#420"/>
        </documentation>
        <documentation>
            <type value="documentation"/>
            <display value="MME Conversion Tables"/>
            <url value="https://www.cdc.gov/drugoverdose/pdf/calculating_total_daily_dose-a.pdf"/>
        </documentation>
        <triggerDefinition>
            <type value="named-event"/>
            <eventName value="medication-prescribe"/>
        </triggerDefinition>
        <condition>
            <kind value="applicability"/>
            <description value="Is total MME >= 50?"/>
            <language value="text/cql"/>
            <expression value="IsMME50OrMore"/>
        </condition>
        <groupingBehavior value="visual-group"/>
        <selectionBehavior value="exactly-one"/>
        <dynamicValue>
            <description value="Dynamic title generation" />
            <expression value="DynamicTitle" />
        </dynamicValue>
        <dynamicValue>
            <description value="Dynamic description generation" />
            <expression value="DynamicDescription" />
        </dynamicValue>
        <!-- Will reduce dosage -->
        <action>
            <description value="Will reduce dosage"/>
            <!-- Open Order Set, where available -->
        </action>
        <!-- Risk of overdose carefully considered and outweighed by benefit; snooze 3 mo -->
        <action>
            <description value="Risk of overdose carefully considered and outweighed by benefit; snooze 3 mo"/>
        </action>
        <!-- Acute pain; snooze 1 mo -->
        <action>
            <description value="Acute pain; snooze 1 mo"/>
        </action>
        <!-- N/A - see comment (will be reviewed by medical director); snooze 3 mo -->
        <action>
            <!-- TODO: How do we indicate through the response that a comment must be captured? -->
            <!-- TODO: How do we communicate the response back to the CDS service for persistence? -->
            <description value="N/A - see comment (will be reviewed by medical director); snooze 3 mo"/>
        </action>
    </action>
</PlanDefinition>